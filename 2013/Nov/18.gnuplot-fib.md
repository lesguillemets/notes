gnuplot で fibonacci 数列，そしてその副産物．
--------------------------------------------

gnuplot も立派な言語，fibonacci くらい書かないと，
と昨日の記事書きながら思った．

### Modern gnuplot
gnuplot の 割と最近のバージョンなら，なんと `for` なんてありがたい expression がある．
これなら勝てる……!!

```
#!/usr/bin/gnuplot
a = 1
b = 1

do for [t=0:30]{
	print b
	a = a+b
	b = a-b
}
```

すばらしい．そして思いの外速い．


### 古い場合

一方 古い gnuplot ではこの表現は使えない．どのくらい古いといけないか，はちょっと未確認なのだが，
確か 現行の 4.6 に対して 4.4 ではまだ使えないという話だったはず．Ubuntu の 12.04 (long term release) とかでは
4.4 だったりするはずなので，今のところまだまだ，どこでも `for` とか使えると思ってはいけなさそうだ．

これでも是非書かないと，という気がしますね．

以前 blog の方で書いたけれど，こういうときはスクリプトごと `reread` してループを再現することができる．
しかしなんか `fibonacci.plt` と `reader.plt` の2つつかうなんて，……という感じがある．

そこで！

`exists()` という関数があり，その変数が定義されてるかどうかを返す，ので…これで分岐を作れば，
自分自身を `reread` しつつ初期化の部分は最初の一回だけ実行，ということができる．
三項演算子を使いながら

```
n = exists('n') ? n-1: 20
a = exists('a') ? a+b: 1
b = exists('b') ? a-b: 1
print b
if (n > 0)\
	reread
```

（最後から二行目の `\` わすれててループが止まらなくて長いこと悩んだ……）

ｺﾎﾝ．ともかくなんか感じる出来だ．めでたし．


### 副産物

副産物というか，調べてたら見つかったいくつかのこと．

* 一行ごとに実行していく感じになるので，複数行にわたる文字列とかつらそうな感じだ． 

```
"\
n = n-1\n\
a = a+b\n\
b = a-b\n\
print b\n\
if n <= 0\n\
	reread\n\
"
```

多分こんなかんじになる．

* `system(command)` っていう関数があって，これで os のコマンドを実行してその返り値を取得できる模様．
* 文字列の結合は `.` .

そんなかんじだが，ともかくまあ，`for` のありがたさよ．
